<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The MiniJuvix Book</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction/about/what-is.html"><strong aria-hidden="true">1.</strong> MiniJuvix</a></li><li class="chapter-item expanded "><a href="introduction/changelog.html"><strong aria-hidden="true">2.</strong> Changelog</a></li><li class="chapter-item expanded "><a href="introduction/getting-started.html"><strong aria-hidden="true">3.</strong> Getting started</a></li><li class="chapter-item expanded "><a href="examples/index.html"><strong aria-hidden="true">4.</strong> Examples</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="examples/backend-specific/minic-hello-world.html"><strong aria-hidden="true">4.1.</strong> Hello world</a></li><li class="chapter-item expanded "><a href="examples/validity-predicates/PolyFungibleToken.html"><strong aria-hidden="true">4.2.</strong> A simple fungible token</a></li></ol></li><li class="chapter-item expanded "><a href="language-reference/index.html"><strong aria-hidden="true">5.</strong> Language reference</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="language-reference/comments.html"><strong aria-hidden="true">5.1.</strong> Comments</a></li><li class="chapter-item expanded "><a href="language-reference/axiom.html"><strong aria-hidden="true">5.2.</strong> Axiom</a></li><li class="chapter-item expanded "><a href="language-reference/functions.html"><strong aria-hidden="true">5.3.</strong> Function</a></li><li class="chapter-item expanded "><a href="language-reference/modules.html"><strong aria-hidden="true">5.4.</strong> Module System</a></li><li class="chapter-item expanded "><a href="language-reference/inductive-data-types.html"><strong aria-hidden="true">5.5.</strong> Inductive data type</a></li><li class="chapter-item expanded "><a href="language-reference/termination-checking.html"><strong aria-hidden="true">5.6.</strong> Termination checking</a></li><li class="chapter-item expanded "><a href="language-reference/compile-blocks.html"><strong aria-hidden="true">5.7.</strong> Compile block</a></li><li class="chapter-item expanded "><a href="language-reference/foreign-blocks.html"><strong aria-hidden="true">5.8.</strong> Foreign block</a></li><li class="chapter-item expanded "><a href="backends/index.html"><strong aria-hidden="true">5.9.</strong> Backends</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="backends/minic.html"><strong aria-hidden="true">5.9.1.</strong> MiniC</a></li><li class="chapter-item expanded "><a href="backends/minihaskell.html"><strong aria-hidden="true">5.9.2.</strong> MiniHaskell</a></li></ol></li><li class="chapter-item expanded "><a href="compiler-architecture/index.html"><strong aria-hidden="true">5.10.</strong> Compiler architecture</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="compiler-architecture/pipeline.html"><strong aria-hidden="true">5.10.1.</strong> Pipeline</a></li><li class="chapter-item expanded "><a href="compiler-architecture/languages.html"><strong aria-hidden="true">5.10.2.</strong> Internal languages</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="compiler-architecture/language/abstract.html"><strong aria-hidden="true">5.10.2.1.</strong> Abstract language</a></li><li class="chapter-item expanded "><a href="compiler-architecture/language/concrete.html"><strong aria-hidden="true">5.10.2.2.</strong> Concrete language</a></li><li class="chapter-item expanded "><a href="compiler-architecture/language/microjuvix.html"><strong aria-hidden="true">5.10.2.3.</strong> MicroJuvix</a></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><a href="tooling/index.html"><strong aria-hidden="true">6.</strong> Tooling</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tools/CLI.html"><strong aria-hidden="true">6.1.</strong> Command line interface</a></li><li class="chapter-item expanded "><a href="tools/emacs-mode.html"><strong aria-hidden="true">6.2.</strong> Emacs mode</a></li><li class="chapter-item expanded "><a href="tools/testing.html"><strong aria-hidden="true">6.3.</strong> Haskell test suite</a></li></ol></li><li class="chapter-item expanded "><a href="notes/index.html"><strong aria-hidden="true">7.</strong> Blog</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="notes/Monomorphization.html"><strong aria-hidden="true">7.1.</strong> Monomorphization</a></li></ol></li><li class="chapter-item expanded "><a href="introduction/about/what-is.html"><strong aria-hidden="true">8.</strong> About</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="introduction/about/team.html"><strong aria-hidden="true">8.1.</strong> The dev team</a></li><li class="chapter-item expanded "><a href="introduction/about/community.html"><strong aria-hidden="true">8.2.</strong> Community</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The MiniJuvix Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="minijuvix"><a class="header" href="#minijuvix">MiniJuvix</a></h1>
<a href="https://github.com/heliaxdev/minijuvix/blob/main/LICENSE">
<img alt="LICENSE" src="https://img.shields.io/badge/license-GPL--3.0--only-blue.svg" />
</a>
<a href="https://github.com/heliaxdev/MiniJuvix/actions/workflows/ci.yml">
<img alt="CI status" src="https://github.com/heliaxdev/MiniJuvix/actions/workflows/ci.yml/badge.svg" />
</a>
<a href="https://github.com/heliaxdev/minijuvix/tags">
<img alt="" src="https://img.shields.io/github/v/release/heliaxdev/minijuvix?include_prereleases" />
</a>
<a href="https://github.com/heliaxdev/minijuvix/issues">
<img alt="" src="https://img.shields.io/github/issues/heliaxdev/minijuvix" />
</a>
<a href="https://github.com/heliaxdev/MiniJuvix">
<img align="right" width="300" height="300" alt="MiniJuvix Mascot" src="https://juvix.org/_nuxt/img/seating-mascot.051c86a.svg" />
</a>
<p>MiniJuvix is a pre-alpha programming language for writing efficient
formally-verified <a href="https://anoma.network/blog/validity-predicates/">validity
predicates</a>, which can
be deployed to various distributed ledgers. MiniJuvix is part of the
Anoma's Juvix Toolkit. At the moment, this is software released for
experimentation and research purposes only as no warranty is provided or
implied yet.</p>
<p>MiniJuvix aims to address many issues that we have experienced while
trying to write and deploy decentralized applications present in the
ecosystem of smart-contracts:</p>
<ul>
<li>the difficulty of adequate program verification,</li>
<li>the ceiling of compositional complexity,</li>
<li>the illegibility of execution costs, and</li>
<li>the lock-in to particular backends.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="changelog"><a class="header" href="#changelog">Changelog</a></h1>
<a href="https://github.com/heliaxdev/MiniJuvix">
<img align="right" width="300" height="300" alt="MiniJuvix Mascot" src="https://juvix.org/_nuxt/img/greeting-mascot.ad540a1.svg" />
</a>
<h2 id="v013"><a class="header" href="#v013"><a href="https://github.com/heliaxdev/minijuvix/tree/v0.1.3">v0.1.3</a></a></h2>
<p>(2022-05-05)</p>
<p><a href="https://github.com/heliaxdev/minijuvix/compare/v0.1.2...v0.1.3">Full
Changelog</a></p>
<p><strong>Closed issues:</strong></p>
<ul>
<li>Monomorphisation naming inconsistency
<a href="https://github.com/heliaxdev/minijuvix/issues/84">#84</a></li>
<li>Remove BackendAgda
<a href="https://github.com/heliaxdev/minijuvix/issues/83">#83</a></li>
<li>Change terminating keyword behavior
<a href="https://github.com/heliaxdev/minijuvix/issues/81">#81</a></li>
<li>MonoJuvix <code>ExpressionTyped</code> is never used
<a href="https://github.com/heliaxdev/minijuvix/issues/79">#79</a></li>
<li>Bump stackage nightly and delete <code>allow-newer: true</code> from
<code>stack.yaml</code>
<a href="https://github.com/heliaxdev/minijuvix/issues/75">#75</a></li>
<li>Generate automatically CHANGELOG and Github Release Notes
<a href="https://github.com/heliaxdev/minijuvix/issues/73">#73</a></li>
<li>Make flag ‚Äìshow-name-ids global
<a href="https://github.com/heliaxdev/minijuvix/issues/61">#61</a></li>
<li>Add C code generation backend
<a href="https://github.com/heliaxdev/minijuvix/issues/60">#60</a></li>
<li>Add polymorphism
<a href="https://github.com/heliaxdev/minijuvix/issues/59">#59</a></li>
<li>Add the compile keyword to the frontend syntax (support up to
Scoping) <a href="https://github.com/heliaxdev/minijuvix/issues/58">#58</a></li>
<li>Error with undefined or underscores
<a href="https://github.com/heliaxdev/minijuvix/issues/54">#54</a></li>
<li>Add support for other GHC and Stack stable version
<a href="https://github.com/heliaxdev/minijuvix/issues/52">#52</a></li>
<li>Autodetect output ANSI support when prettyprinting
<a href="https://github.com/heliaxdev/minijuvix/issues/38">#38</a></li>
<li>Terminating for type signatures
<a href="https://github.com/heliaxdev/minijuvix/issues/11">#11</a></li>
</ul>
<p><strong>Merged pull requests:</strong></p>
<ul>
<li>Remove agda backend
<a href="https://github.com/heliaxdev/minijuvix/pull/86">#86</a>
(<a href="https://github.com/paulcadman">paulcadman</a>)</li>
<li>84 monomorphisation naming inconsistency
<a href="https://github.com/heliaxdev/minijuvix/pull/85">#85</a>
(<a href="https://github.com/janmasrovira">janmasrovira</a>)</li>
<li>Change terminating keyword behavior
<a href="https://github.com/heliaxdev/minijuvix/pull/82">#82</a>
(<a href="https://github.com/jonaprieto">jonaprieto</a>)</li>
<li>Remove unused constructor ExpressionTyped in Monojuvix
<a href="https://github.com/heliaxdev/minijuvix/pull/80">#80</a>
(<a href="https://github.com/janmasrovira">janmasrovira</a>)</li>
<li>Stricter stack builds and pedantic mode for CI
<a href="https://github.com/heliaxdev/minijuvix/pull/78">#78</a>
(<a href="https://github.com/jonaprieto">jonaprieto</a>)</li>
<li>Bump stackage version and remove allow-newer
<a href="https://github.com/heliaxdev/minijuvix/pull/76">#76</a>
(<a href="https://github.com/janmasrovira">janmasrovira</a>)</li>
<li>Add automatically updates/issues/merged PRs to the changelog
<a href="https://github.com/heliaxdev/minijuvix/pull/74">#74</a>
(<a href="https://github.com/jonaprieto">jonaprieto</a>)</li>
<li>Add terminating keyword
<a href="https://github.com/heliaxdev/minijuvix/pull/71">#71</a>
(<a href="https://github.com/jonaprieto">jonaprieto</a>)</li>
<li>Monomorphization
<a href="https://github.com/heliaxdev/minijuvix/pull/70">#70</a>
(<a href="https://github.com/janmasrovira">janmasrovira</a>)</li>
<li>Remove StatementCompile in AST after scoping
<a href="https://github.com/heliaxdev/minijuvix/pull/69">#69</a>
(<a href="https://github.com/paulcadman">paulcadman</a>)</li>
<li>Add C code generation backend
<a href="https://github.com/heliaxdev/minijuvix/pull/68">#68</a>
(<a href="https://github.com/paulcadman">paulcadman</a>)</li>
<li>Check if stderr supports ANSI and print accordingly
<a href="https://github.com/heliaxdev/minijuvix/pull/67">#67</a>
(<a href="https://github.com/janmasrovira">janmasrovira</a>)</li>
<li>Add support for compile (by Jonathan)
<a href="https://github.com/heliaxdev/minijuvix/pull/66">#66</a>
(<a href="https://github.com/paulcadman">paulcadman</a>)</li>
<li>Add NameIdGen effect to the pipeline
<a href="https://github.com/heliaxdev/minijuvix/pull/64">#64</a>
(<a href="https://github.com/janmasrovira">janmasrovira</a>)</li>
<li>Make the <code>--show-name-ids</code> flag global
<a href="https://github.com/heliaxdev/minijuvix/pull/63">#63</a>
(<a href="https://github.com/janmasrovira">janmasrovira</a>)</li>
<li>Implement type checker with polymorphism
<a href="https://github.com/heliaxdev/minijuvix/pull/62">#62</a>
(<a href="https://github.com/janmasrovira">janmasrovira</a>)</li>
</ul>
<h2 id="v012"><a class="header" href="#v012"><a href="https://github.com/heliaxdev/minijuvix/tree/v0.1.2">v0.1.2</a></a></h2>
<p>(2022-04-11)</p>
<p><a href="https://github.com/heliaxdev/minijuvix/compare/v0.1.1...v0.1.2">Full
Changelog</a></p>
<p><strong>Closed issues:</strong></p>
<ul>
<li>Add en emacs mode with support for scoped highlighting
<a href="https://github.com/heliaxdev/minijuvix/issues/25">#25</a></li>
<li>Add support for project root detection through a minijuvix.yaml file
<a href="https://github.com/heliaxdev/minijuvix/issues/24">#24</a></li>
<li>Add CLI cmd to generate minijuvix autocompletion files for fish and
zsh <a href="https://github.com/heliaxdev/minijuvix/issues/23">#23</a></li>
<li>Add pretty and typecheck subcommands to the microjuvix CLI
<a href="https://github.com/heliaxdev/minijuvix/issues/21">#21</a></li>
<li>Translate identifiers from MicroJuvix to MiniHaskell (valid Haskell)
<a href="https://github.com/heliaxdev/minijuvix/issues/19">#19</a></li>
<li>Implement the MiniHaskell to Haskell translation (prettyprinter)
<a href="https://github.com/heliaxdev/minijuvix/issues/18">#18</a></li>
<li>Implementation of a typechecker for MicroJuvix
<a href="https://github.com/heliaxdev/minijuvix/issues/16">#16</a></li>
<li>Add references to the Abstract AST to update compilation to
MiniHaskell <a href="https://github.com/heliaxdev/minijuvix/issues/12">#12</a></li>
<li>Order in the house
<a href="https://github.com/heliaxdev/minijuvix/issues/10">#10</a></li>
</ul>
<p><strong>Merged pull requests:</strong></p>
<ul>
<li>The MiniJuvix project now follows the same goals as the original
Juvix project. <a href="https://github.com/heliaxdev/minijuvix/pull/7">#7</a>
(<a href="https://github.com/jonaprieto">jonaprieto</a>)</li>
<li>Dev‚Üímain <a href="https://github.com/heliaxdev/minijuvix/pull/6">#6</a>
(<a href="https://github.com/jonaprieto">jonaprieto</a>)</li>
<li>Big update including termination checking
<a href="https://github.com/heliaxdev/minijuvix/pull/5">#5</a>
(<a href="https://github.com/janmasrovira">janmasrovira</a>)</li>
<li>Parser and scoper
<a href="https://github.com/heliaxdev/minijuvix/pull/3">#3</a>
(<a href="https://github.com/jonaprieto">jonaprieto</a>)</li>
<li>Upgrade to ghc9 and use hpack
<a href="https://github.com/heliaxdev/minijuvix/pull/2">#2</a>
(<a href="https://github.com/janmasrovira">janmasrovira</a>)</li>
<li>Merge <a href="https://github.com/heliaxdev/minijuvix/pull/1">#1</a>
(<a href="https://github.com/jonaprieto">jonaprieto</a>)</li>
</ul>
<h2 id="v011"><a class="header" href="#v011"><a href="https://github.com/heliaxdev/minijuvix/tree/v0.1.1">v0.1.1</a></a></h2>
<p>(2022-03-25)</p>
<p><a href="https://github.com/heliaxdev/minijuvix/compare/48abde93b4e5380acabac810e584f4b7a6618592...v0.1.1">Full
Changelog</a></p>
<ul>
<li>Add support in the parser/scoper for Axiom backends</li>
<li>Add support for <code>foreign</code> keyword</li>
<li>Add flag <code>--no-colors</code> for the scope command</li>
<li>Upgrade to GHC 9.2.2</li>
<li>Improve resolution of local symbols in the scoper</li>
<li>Several new tests related to ambiguous symbols</li>
<li>Add <code>--version</code> flag</li>
<li>Add InfoTableBuilder effect for the scoper</li>
</ul>
<p><strong>Closed issues:</strong></p>
<ul>
<li>Add diff output to the test suite
<a href="https://github.com/heliaxdev/minijuvix/issues/9">#9</a></li>
<li>Improve scoper ambiguity error messages
<a href="https://github.com/heliaxdev/minijuvix/issues/8">#8</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-started"><a class="header" href="#getting-started">Getting started</a></h1>
<h2 id="quick-start"><a class="header" href="#quick-start">Quick Start</a></h2>
<a href="https://github.com/heliaxdev/MiniJuvix">
<img align="left" width="200" height="200" alt="MiniJuvix Mascot" src="https://juvix.org/_nuxt/img/teaching-mascot.f828959.svg" />
</a>
<p>To install MiniJuvix, you can download its sources using
<a href="http://git-scm.com/">Git</a> from the <a href="https://github.com/heliaxdev/minijuvix.git">Github
repository</a>. Then, the
program can be downloaded and installed with the following commands. You
will need to have <a href="https://haskellstack.org">Stack</a> installed.</p>
<pre><code>git clone https://github.com/heliaxdev/minijuvix.git
cd minijuvix
stack install
</code></pre>
<p>If the installation succeeds, you must be able to run the <code>minijuvix</code>
command from any location.</p>
<p>To get the complete list of commands, please run <code>minijuvix --help</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><ul>
<li><a href="examples/./examples/backend-specific/minic-hello-world.html">Hello world</a></li>
<li><a href="examples/./examples/validity-predicates/PolyFungibleToken.html">Fungible
Token</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mini-c-hello-world"><a class="header" href="#mini-c-hello-world">Mini C Hello World</a></h1>
<p>In the following example a MiniJuvix file is compiled using the C
backend.</p>
<pre><code>-- tests/positive/MiniC/HelloWorld/Input.mjuvix
module Input;

axiom String : Type;

compile String {
  c ‚Ü¶ &quot;char*&quot;;
};

axiom Action : Type;

compile Action {
  c ‚Ü¶ &quot;int&quot;;
};

axiom put-str-ln : String ‚Üí Action;

compile put-str-ln {
  c ‚Ü¶ &quot;putStrLn&quot;;
};

main : Action;
main ‚âî put-str-ln &quot;hello world!&quot;;

end;
</code></pre>
<p>The result is compiled to WASM using <a href="https://llvm.org">Clang</a> and then
executed using <a href="https://wasmer.io">wasmer</a>.</p>
<p>NB: Set the <code>WASI_SYSROOT_PATH</code> environment variable to the root of the
WASI sysroot. See <a href="examples/backend-specific/minic-hello-world.html#Dependencies">Dependencies</a> for instructions on how
to install the sysroot.</p>
<pre><code>cd tests/positive/MiniC/HelloWorld
minijuvix minic Input.mjuvix | clang --target=wasm32-wasi -nodefaultlibs -lc --sysroot $WASI_SYSROOT_PATH -I../../../../minic-runtime/libc -x c - -o out.wasm &amp;&amp; wasmer out.wasm
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><pre><code>-- tests/positive/FullExamples/PolySimpleFungibleToken.mjuvix
module PolySimpleFungibleToken;

foreign ghc {
  import Anoma
};

--------------------------------------------------------------------------------
-- Booleans
--------------------------------------------------------------------------------

inductive Bool {
  true : Bool;
  false : Bool;
};

infixr 2 ||;
|| : Bool ‚Üí Bool ‚Üí Bool;
|| false a ‚âî a;
|| true _ ‚âî true;

infixr 3 &amp;&amp;;
&amp;&amp; : Bool ‚Üí Bool ‚Üí Bool;
&amp;&amp; false _ ‚âî false;
&amp;&amp; true a ‚âî a;

if : (A : Type) ‚Üí Bool ‚Üí A ‚Üí A ‚Üí A;
if _ true a _ ‚âî a;
if _ false _ b ‚âî b;

--------------------------------------------------------------------------------
-- Backend Booleans
--------------------------------------------------------------------------------

axiom BackendBool : Type;

compile BackendBool {
  ghc ‚Ü¶ &quot;Bool&quot;;
};

axiom backend-true : BackendBool;
compile backend-true {
  ghc ‚Ü¶ &quot;True&quot;;
};

axiom backend-false : BackendBool;
compile backend-false {
  ghc ‚Ü¶ &quot;False&quot;;
};

--------------------------------------------------------------------------------
-- Backend Bridge
--------------------------------------------------------------------------------

foreign ghc {
  bool :: Bool -&gt; a -&gt; a -&gt; a
  bool True x _ = x
  bool False _ y = y
};

axiom bool : BackendBool ‚Üí Bool ‚Üí Bool ‚Üí Bool;
compile bool {
  ghc ‚Ü¶ &quot;bool&quot;;
};

from-backend-bool : BackendBool ‚Üí Bool;
from-backend-bool bb ‚âî bool bb true false;

--------------------------------------------------------------------------------
-- Functions
--------------------------------------------------------------------------------

const : (A : Type) ‚Üí (B : Type) ‚Üí A ‚Üí B ‚Üí A;
const _ _ a _ ‚âî a;

id : (A : Type) ‚Üí A ‚Üí A;
id _ a ‚âî a;

--------------------------------------------------------------------------------
-- Integers
--------------------------------------------------------------------------------

axiom Int : Type;
compile Int {
  ghc ‚Ü¶ &quot;Int&quot;;
};

infix 4 &lt;';
axiom &lt;' : Int ‚Üí Int ‚Üí BackendBool;
compile &lt;' {
  ghc ‚Ü¶ &quot;(&lt;)&quot;;
};

infix 4 &lt;;
&lt; : Int ‚Üí Int ‚Üí Bool;
&lt; i1 i2 ‚âî from-backend-bool (i1 &lt;' i2);

axiom eqInt : Int ‚Üí Int ‚Üí BackendBool;
compile eqInt {
  ghc ‚Ü¶ &quot;(==)&quot;;
};

infix 4 ==Int;
==Int : Int ‚Üí Int ‚Üí Bool;
==Int i1 i2 ‚âî from-backend-bool (eqInt i1 i2);

infixl 6 -;
axiom - : Int -&gt; Int -&gt; Int;
compile - {
  ghc ‚Ü¶ &quot;(-)&quot;;
};

infixl 6 +;
axiom + : Int -&gt; Int -&gt; Int;
compile + {
  ghc ‚Ü¶ &quot;(+)&quot;;
};

--------------------------------------------------------------------------------
-- Strings
--------------------------------------------------------------------------------

axiom String : Type;
compile String {
  ghc ‚Ü¶ &quot;[Char]&quot;;
};

axiom eqString : String ‚Üí String ‚Üí BackendBool;
compile eqString  {
  ghc ‚Ü¶ &quot;(==)&quot;;
};

infix 4 ==String;
==String : String ‚Üí String ‚Üí Bool;
==String s1 s2 ‚âî from-backend-bool (eqString s1 s2);

--------------------------------------------------------------------------------
-- Lists
--------------------------------------------------------------------------------

inductive List (A : Type) {
  nil : List A;
  cons : A ‚Üí List A ‚Üí List A;
};

elemGen : (A : Type) ‚Üí (A ‚Üí A ‚Üí Bool) ‚Üí A ‚Üí List A ‚Üí Bool;
elemGen _ _ _ nil ‚âî false;
elemGen A eq s (cons x xs) ‚âî eq s x || elemGen A eq s xs;

elem : String ‚Üí List String ‚Üí Bool;
elem s l ‚âî elemGen String (==String) s l;

foldl : (A : Type) ‚Üí (B : Type) ‚Üí (B ‚Üí A ‚Üí B) ‚Üí B ‚Üí List A ‚Üí B;
foldl _ _ f z nil ‚âî z;
foldl A B f z (cons h hs) ‚âî foldl A B f (f z h) hs;

--------------------------------------------------------------------------------
-- Pair
--------------------------------------------------------------------------------

-- inductive PairIntBool {
--   MakePair : Int ‚Üí Bool ‚Üí PairIntBool;
-- };

inductive Pair (A : Type) (B : Type) {
  mkPair : A ‚Üí B ‚Üí Pair A B;
};

if-pairIntBool : Bool ‚Üí Pair Int Bool ‚Üí Pair Int Bool ‚Üí Pair Int Bool;
if-pairIntBool ‚âî if (Pair Int Bool);

--------------------------------------------------------------------------------
-- Maybe
--------------------------------------------------------------------------------

inductive Maybe (A : Type) {
 nothing : Maybe A;
 just : A ‚Üí Maybe A;
};

if-optionInt : Bool ‚Üí Maybe Int ‚Üí Maybe Int ‚Üí Maybe Int;
if-optionInt ‚âî if (Maybe Int);

from-int : Int ‚Üí Maybe Int;
from-int i ‚âî if-optionInt (i &lt; 0) (nothing Int) (just Int i);

maybe : (A : Type) ‚Üí (B : Type) ‚Üí B ‚Üí (A ‚Üí B) ‚Üí Maybe A ‚Üí B;
maybe _ _ b _ nothing ‚âî b;
maybe _ _ _ f (just x) ‚âî f x;

maybe-int : Int ‚Üí Maybe Int ‚Üí Int;
maybe-int d ‚âî maybe Int Int d (id Int);

if-optionString : Bool ‚Üí Maybe String ‚Üí Maybe String ‚Üí Maybe String;
if-optionString ‚âî if (Maybe String);

from-string : String ‚Üí Maybe String;
from-string s ‚âî if-optionString (s ==String &quot;&quot;) (nothing String) (just String s);

pair-from-optionString : (String ‚Üí Pair Int Bool) ‚Üí Maybe String ‚Üí Pair Int Bool;
pair-from-optionString ‚âî maybe String (Pair Int Bool) (mkPair Int Bool 0 false);

--------------------------------------------------------------------------------
-- foldl
--------------------------------------------------------------------------------

foldl' : (Pair Int Bool ‚Üí String ‚Üí Pair Int Bool) ‚Üí Pair Int Bool ‚Üí List String ‚Üí Pair Int Bool;
foldl' ‚âî foldl String (Pair Int Bool) ;

--------------------------------------------------------------------------------
-- Anoma
--------------------------------------------------------------------------------

axiom readPre : String ‚Üí Int;
compile readPre {
  ghc ‚Ü¶ &quot;readPre&quot;;
};

axiom readPost : String ‚Üí Int;
compile readPost {
  ghc ‚Ü¶ &quot;readPost&quot;;
};

axiom isBalanceKey : String ‚Üí String ‚Üí String;
compile isBalanceKey {
  ghc ‚Ü¶ &quot;isBalanceKey&quot;;
};

read-pre : String ‚Üí Maybe Int;
read-pre s ‚âî from-int (readPre s);

read-post : String ‚Üí Maybe Int;
read-post s ‚âî from-int (readPost s);

is-balance-key : String ‚Üí String ‚Üí Maybe String;
is-balance-key token key ‚âî from-string (isBalanceKey token key);

unwrap-default : Maybe Int ‚Üí Int;
unwrap-default o ‚âî maybe-int 0 o;

--------------------------------------------------------------------------------
-- Validity Predicate
--------------------------------------------------------------------------------

change-from-key : String ‚Üí Int;
change-from-key key ‚âî unwrap-default (read-post key) - unwrap-default (read-pre key);

check-vp : List String ‚Üí String ‚Üí Int ‚Üí String ‚Üí Pair Int Bool;
check-vp verifiers key change owner ‚âî
    if-pairIntBool
        (change-from-key key &lt; 0)
        -- make sure the spender approved the transaction
        (mkPair Int Bool (change + (change-from-key key)) (elem owner verifiers))
        (mkPair Int Bool (change + (change-from-key key)) true);

check-keys : String ‚Üí List String ‚Üí Pair Int Bool ‚Üí String ‚Üí Pair Int Bool;
check-keys token verifiers (mkPair change is-success) key ‚âî
    if-pairIntBool
        is-success
        (pair-from-optionString (check-vp verifiers key change) (is-balance-key token key))
        (mkPair Int Bool 0 false);

check-result : Pair Int Bool ‚Üí Bool;
check-result (mkPair change all-checked) ‚âî (change ==Int 0) &amp;&amp; all-checked;

vp : String ‚Üí List String ‚Üí List String ‚Üí Bool;
vp token keys-changed verifiers ‚âî
    check-result
        (foldl'
            (check-keys token verifiers)
            (mkPair Int Bool 0 true)
            keys-changed);

--------------------------------------------------------------------------------
-- IO
--------------------------------------------------------------------------------

axiom Action : Type;
compile Action {
 ghc ‚Ü¶ &quot;IO ()&quot;;
};

axiom putStr : String ‚Üí Action;
compile putStr {
  ghc ‚Ü¶ &quot;putStr&quot;;
};

axiom putStrLn : String ‚Üí Action;
compile putStrLn {
  ghc ‚Ü¶ &quot;putStrLn&quot;;
};

infixl 1 &gt;&gt;;
axiom &gt;&gt; : Action ‚Üí Action ‚Üí Action;
compile &gt;&gt; {
  ghc ‚Ü¶ &quot;(&gt;&gt;)&quot;;
};

show-result : Bool ‚Üí String;
show-result true ‚âî &quot;OK&quot;;
show-result false ‚âî &quot;FAIL&quot;;

--------------------------------------------------------------------------------
-- Testing VP
--------------------------------------------------------------------------------

token : String;
token ‚âî &quot;owner-token&quot;;

owner-address : String;
owner-address ‚âî &quot;owner-address&quot;;

change1-key : String;
change1-key ‚âî &quot;change1-key&quot;;

change2-key : String;
change2-key ‚âî &quot;change2-key&quot;;

verifiers : List String;
verifiers ‚âî cons String owner-address (nil String);

keys-changed : List String;
keys-changed ‚âî cons String change1-key (cons String change2-key (nil String));

main : Action;
main ‚âî
    (putStr &quot;VP Status: &quot;)
    &gt;&gt; (putStrLn (show-result (vp token keys-changed verifiers)));

end;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><ul>
<li><a href="language-reference/./language-reference/comments.html">Comments</a></li>
<li><a href="language-reference/./language-reference/axiom.html">Axiom</a></li>
<li><a href="language-reference/./language-reference/functions.html">Function</a></li>
<li><a href="language-reference/./language-reference/modules.html">Module System</a></li>
<li><a href="language-reference/./language-reference/inductive-data-types.html">Inductive data type</a></li>
<li><a href="language-reference/./language-reference/termination-checking.html">Termination checking</a></li>
<li><a href="language-reference/./language-reference/compile-blocks.html">Compile block</a></li>
<li><a href="language-reference/./language-reference/foreign-blocks.html">Foreign block</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="comments"><a class="header" href="#comments">Comments</a></h1>
<p>A comment is introduced in the same fashion as in Haskell/Agda.</p>
<ul>
<li>Inline Comment</li>
</ul>
<!-- -->
<pre><code>-- This is a comment!
</code></pre>
<ul>
<li>Region comment</li>
</ul>
<!-- -->
<pre><code>{-
    This is a comment!

-}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="axiom"><a class="header" href="#axiom">Axiom</a></h1>
<p>An axiom/postulate can be introduced by using the <code>axiom</code> keyword. For
example, let us imagine one wants to write a program that assumes <em>A</em> is
a type and there exist a term <em>x</em> that inhabits <em>A</em>. Then the program
would like like the following.</p>
<pre><code>-- Example.mjuvix
module Example;
 axiom A : Type;
 axom x : A;
end;
</code></pre>
<p>Terms introduced by the <code>axiom</code> keyword lack of any computational
content. However, it is possible to attach a computational content to an
axiom by giving compilation rules, see <a href="language-reference/./language-reference/compile-blocks.html">Compile
blocks</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="function-declaration"><a class="header" href="#function-declaration">Function declaration</a></h1>
<p>In MiniJuvix, a function declaration is a type signature <em>and</em> a group
of definitions called <em>function clauses</em>.</p>
<pre><code>fun : A ‚Üí B;
fun case1 := ...;
fun case2 := ...;
fun case3 := ...;
</code></pre>
<h2 id="mutual-recursive-functions"><a class="header" href="#mutual-recursive-functions">Mutual recursive functions</a></h2>
<pre><code>f : A -&gt; A -&gt; A;
g : A -&gt; A -&gt; A;

g x y := f x x;
f x y := g x (f x x);
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="module-system"><a class="header" href="#module-system">Module system</a></h1>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="termination-checking"><a class="header" href="#termination-checking">Termination checking</a></h1>
<p>To not bring inconsistencies by function declarations, MiniJuvix
requires that all function pass the termination checker. This check is
called before the typechecking in the compilation pipeline.</p>
<p>Since the former requirement is vital but often tricky to fulfill for
programs in a total language like MiniJuvix. It is convenient to have a
way to bypass the termination checking. The user may be certain their
programs are terminating even when our termination checker algorithm can
not see it. The termination checker is limited as it only accepts a
subset of recursion functions. Our termination checker algorithm is a
slightly modification of the algorithm for checking terminationg of the
Foetus's language.</p>
<p>To skip the termination checker, we introduced the <code>terminating</code> keyword
to annotate a type signature as terminating. The syntax is the
following.</p>
<pre><code>terminating fun : A ‚Üí B;
</code></pre>
<p>Annotating a function as <code>terminating</code> means that <em>all</em> its function
clauses pass the termination checker's criterion. To skip the
termination checker for mutual recursive functions, all the functions
involved must be annotated as <code>terminating</code>, otherwise, the checker will
complain.</p>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><ul>
<li><a href="backends/./backends/minic.html">MiniC backend</a></li>
<li><a href="backends/./backends/minihaskell.html">MiniHaskell backend</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="minic-backend"><a class="header" href="#minic-backend">MiniC Backend</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="minihaskell-backend"><a class="header" href="#minihaskell-backend">MiniHaskell Backend</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compiler-architecture"><a class="header" href="#compiler-architecture">Compiler architecture</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pipeline"><a class="header" href="#pipeline">Pipeline</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="internal-minijuvix-languages"><a class="header" href="#internal-minijuvix-languages">Internal MiniJuvix languages</a></h1>
<h2 id="languages"><a class="header" href="#languages">Languages</a></h2>
<ul>
<li><a href="compiler-architecture/./compiler-architecture/language/abstract.html">Abstract Language</a></li>
<li><a href="compiler-architecture/./compiler-architecture/language/concrete.html">Concrete language</a></li>
<li><a href="compiler-architecture/./compiler-architecture/language/microjuvix.html">MicroJuvix
Language</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="abstract-internal-language"><a class="header" href="#abstract-internal-language">Abstract Internal Language</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="concrete-internal-language"><a class="header" href="#concrete-internal-language">Concrete Internal Language</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="microjuvix-internal-language"><a class="header" href="#microjuvix-internal-language">MicroJuvix Internal Language</a></h1>
<div style="break-before: page; page-break-before: always;"></div><ul>
<li><a href="tooling/./tools/CLI.html">Command line Interface</a></li>
<li><a href="tooling/./tools/emacs-mode.html">Writting MiniJuvix programs with Emacs Mode</a></li>
<li><a href="tooling/./tools/testing.html">Test Suite</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="command-line-interface"><a class="header" href="#command-line-interface">Command line interface</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="emacs-mode"><a class="header" href="#emacs-mode">Emacs mode</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="haskell-test-suite"><a class="header" href="#haskell-test-suite">Haskell test suite</a></h1>
<div style="break-before: page; page-break-before: always;"></div><ul>
<li><a href="notes/./notes/Monomorphization.html">Monomorphization</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="monomorphization"><a class="header" href="#monomorphization">Monomorphization</a></h1>
<p><em>By Jan Mais Rovira</em></p>
<p>Monomorphization refers to the process of converting polymorphic code to
monomorphic code (no type variables) through static analysis.</p>
<p>Example:</p>
<pre><code>id : (A : Type) ‚Üí A ‚Üí A;
id _ a ‚âî a;

b : Bool;
b ‚âî id Bool true;

n : Nat;
n ‚âî id Nat zero;
</code></pre>
<p>Is translated into:</p>
<pre><code>id_Bool : Bool ‚Üí Bool;
id_Bool a ‚âî a;

id_Nat : Nat ‚Üí Nat;
id_Nat a ‚âî a;
</code></pre>
<h1 id="more-examples"><a class="header" href="#more-examples">More examples</a></h1>
<h2 id="mutual-recursion"><a class="header" href="#mutual-recursion">Mutual recursion</a></h2>
<pre><code>inductive List (A : Type) {
  nil : List A;
  cons : A ‚Üí List A ‚Üí List A;
};

even : (A : Type) ‚Üí List A ‚Üí Bool;
even A nil ‚âî true ;
even A (cons _ xs) ‚âî not (odd A xs) ;

odd : (A : Type) ‚Üí List A ‚Üí Bool;
odd A nil ‚âî false ;
odd A (cons _ xs) ‚âî not (even A xs) ;

-- main ‚âî even Bool ..  odd Nat;
</code></pre>
<h1 id="collection-algorithm"><a class="header" href="#collection-algorithm">Collection algorithm</a></h1>
<p>This section describes the algorithm to collect the list of all concrete
functions and inductive definitions that need to be generated.</p>
<h2 id="assumptions"><a class="header" href="#assumptions">Assumptions:</a></h2>
<ol>
<li>Type abstractions only appear at the leftmost part of a type
signature.</li>
<li>All functions and constructors are fully type-applied: i.e. currying
for types is not supported.</li>
<li>There is at least one function with a concrete type signature.</li>
<li>All axioms are monomorphic.</li>
<li>No module parameters.</li>
</ol>
<h2 id="definitions"><a class="header" href="#definitions">Definitions</a></h2>
<ol>
<li>
<p><strong>Application</strong>. An application is an expression of the form
<code>t‚ÇÅ t‚ÇÇ ‚Ä¶ t‚Çô</code> with n &gt; 0.</p>
</li>
<li>
<p><strong>Sub application</strong>. If <code>t‚ÇÅ t‚ÇÇ ‚Ä¶ t‚Çô</code> is an application then for
every <code>0&lt;i&lt;n</code> <code>t‚ÇÅ t‚ÇÇ ‚Ä¶ t·µ¢</code> is a sub application.</p>
</li>
</ol>
<p>Fix a minijuvix program <code>P</code>. Let <code>ùí≤</code> be the set of all applications that
appear in <code>P</code>.</p>
<ol>
<li>
<p><strong>Maximal application</strong>. A maximal application is an application
<code>A‚ààùí≤</code> such that for every <code>A'‚ààùí≤</code> we have that <code>A</code> is <strong>not</strong> a sub
application of <code>A'</code>.</p>
</li>
<li>
<p><strong>Type application</strong>. If</p>
<ol>
<li><code>t a‚ÇÅ a‚ÇÇ ‚Ä¶ a‚Çô</code> is a maximal application; and</li>
<li><code>t</code> is either a function or an inductive type; and</li>
<li><code>a‚ÇÅ, ‚Ä¶, a‚Çò</code> are types; and</li>
<li><code>a‚Çò‚Çä‚ÇÅ</code> is not a type or <code>m = n</code>.</li>
</ol>
<p>Then <code>t a‚ÇÅ, ‚Ä¶, a‚Çò</code> is a type application.</p>
</li>
<li>
<p><strong>Concrete type</strong>. A type is concrete if it involves no type
variables.</p>
</li>
<li>
<p><strong>Concrete type application</strong>. A type application <code>t a‚ÇÅ a‚ÇÇ ‚Ä¶ a‚Çô</code> if
<code>a‚ÇÅ, a‚ÇÇ, ‚Ä¶, a‚Çô</code> are concrete types.</p>
</li>
</ol>
<h2 id="option-1"><a class="header" href="#option-1">Option 1</a></h2>
<p>Let <code>S‚ÇÄ</code> be the set of functions with a concrete type signature. Gather
all type applications (both in the type and in the body) in each of the
functions in <code>S‚ÇÄ</code>. Clearly the collected type applications are all
concrete. We now have a stack <code>c‚ÇÅ, c‚ÇÇ, ‚Ä¶, c‚Çô</code> of concrete type
applications.</p>
<ol>
<li>If the stack is empty, we are done.</li>
<li>Otherwise pop <code>c‚ÇÅ</code> from the stack. It will be of the form
<code>t a‚ÇÅ ‚Ä¶ a‚Çò</code>, where <code>t</code> is either an inductive or a function and
<code>a‚ÇÅ, ‚Ä¶, a‚Çò</code> are concrete types.</li>
<li>If the instantiation <code>t a‚ÇÅ ‚Ä¶ a‚Çò</code> has already been registered go to
step 1. Otherwise continue to the next step.</li>
<li>Register the instantiation <code>t a‚ÇÅ ‚Ä¶ a‚Çò</code>.</li>
<li>If <code>t</code> is a function, then it has type variables <code>v‚ÇÅ, ‚Ä¶, v‚Çò</code>.
Consider the substitution <code>œÉ = {v‚ÇÅ ‚Ü¶ a‚ÇÅ, ‚Ä¶, v‚Çò ‚Ü¶ a‚Çò}</code>. Consider the
list of type applications in the body of <code>t</code>: <code>d‚ÇÅ, ‚Ä¶, d·µ£</code>. Add
<code>œÉ(d‚ÇÅ), ‚Ä¶, œÉ(d·µ£)</code> to the stack and continue to step 1. It is easy to
see that for any <code>i</code>, <code>œÉ(d·µ¢)</code> is a concrete type application.</li>
<li>If <code>t</code> is an inductive type, let <code>d‚ÇÅ, ‚Ä¶, d·µ£</code> be the type
applications that appear in the type of its constructors, then
proceed as before.</li>
</ol>
<h3 id="correctness"><a class="header" href="#correctness">Correctness</a></h3>
<p>It should be clear that the algorithm terminates and registers all
instantiations of constructors and functions.</p>
<h1 id="generation-algorithm"><a class="header" href="#generation-algorithm">Generation algorithm</a></h1>
<p>The input of this algorithm is the list of concrete type applications,
name it <code>‚Ñí</code>, produced by the collection algorithm. Example:</p>
<pre><code>List String
Pair Int Bool
Maybe String
Maybe Int
if (Maybe String)
if (Maybe Int)
if (Pair Int Bool)
</code></pre>
<h2 id="name-generation"><a class="header" href="#name-generation">Name generation</a></h2>
<p>Let <code>f √¢</code> be an arbitrary element of <code>‚Ñí</code>, where <code>√¢</code> is a list of
concrete types.</p>
<ul>
<li>If <code>f</code> is a function, assign a fresh name to <code>f √¢</code>, call it
<code>‚ãÜ(f √¢)</code>.</li>
<li>If <code>f</code> is an inductive type, assign a fresh name to <code>f √¢</code>, call it
<code>‚ãÜ(f √¢)</code>. Then, for each constructor <code>c·µ¢</code> of <code>f</code>, where <code>i</code> is the
index of the constructor, assign a fresh name to it and call it
<code>‚ãÜ·µ¢(f √¢)</code>.</li>
</ul>
<h2 id="function-generation"><a class="header" href="#function-generation">Function generation</a></h2>
<p>Consider an arbitrary function <code>f</code> in the original program. Then
consider the list of concrete type applications involving <code>f</code>:
<code>f √¢‚ÇÅ, ‚Ä¶, f √¢‚Çô</code>.</p>
<ul>
<li>If <code>n = 0</code>, then either:
<ol>
<li><code>f</code> has a concrete type signature, in that case we proceed as
expected.</li>
<li><code>f</code> is never called from the functions with a concrete type. In
this case we can safely ignore it.</li>
</ol>
</li>
<li>If <code>n &gt; 1</code>. For each <code>√¢·µ¢</code> we proceed as follows in the next
sections. Fix <code>m</code> to be the lenght of <code>√¢·µ¢</code> with <code>m &gt; 0</code>.</li>
</ul>
<h3 id="function-name"><a class="header" href="#function-name">Function name</a></h3>
<p>The name of the monomorphized function is <code>‚ãÜ(f √¢·µ¢)</code>.</p>
<h3 id="type-signature"><a class="header" href="#type-signature">Type signature</a></h3>
<p>Let <code>ùíÆ</code> be the type signature of <code>f</code>. Then <code>ùíÆ</code> has to be of the form
<code>(A‚ÇÅ : Type) ‚Üí ‚Ä¶ ‚Üí (A‚Çò : Type) ‚Üí Œ†</code>, where <code>Œ†</code> is a type with no type
abstractions. Now consider the substitution
<code>œÉ = {A‚ÇÅ ‚Ü¶ √¢·µ¢[1], ‚Ä¶, A‚Çò ‚Ü¶ √¢·µ¢[m]}</code>. Since <code>√¢·µ¢</code> is a list of concrete
types, it is clear that <code>œÉ(Œ†)</code> is a concrete type. Then proceed as
described in <span class="spurious-link" target="Types"><em>Types</em></span>.</p>
<h3 id="function-clause"><a class="header" href="#function-clause">Function clause</a></h3>
<p>Let <code>ùíû</code> be a function clause of <code>f</code>. Let <code>p‚ÇÅ ‚Ä¶ p‚Çñ</code> with <code>k ‚â• m</code> be the
list of patterns in <code>ùíû</code>. Clearly the first <code>m</code> patterns must be either
variables or wildcards. Wlog assume that the first <code>m</code> patterns are all
variables, namely <code>v‚ÇÅ, ‚Ä¶, v‚Çò</code>. Let <code>œÉ = {v‚ÇÅ ‚Ü¶ √¢·µ¢[1], ‚Ä¶, A‚Çò ‚Ü¶ √¢·µ¢[m]}</code> be
a substitution. Let <code>e</code> be the body of <code>ùíû</code>, then clearly <code>œÉ(e)</code> has no
type variables in it. Now, since each name id must be bound at most
once, we need to generate new ones for the local variables bound in the
patterns <code>p‚Çò‚Çä‚ÇÅ, ‚Ä¶, p‚Çñ</code>. Let <code>w‚ÇÅ, ‚Ä¶, w‚Çõ</code> be the variables bound in
<code>p‚Çò‚Çä‚ÇÅ, ‚Ä¶, p‚Çñ</code>. Let <code>w'‚ÇÅ, ‚Ä¶, w'‚Çõ</code> be fresh variables. Then let
<code>Œ¥ = {w‚ÇÅ ‚Ü¶ w'‚ÇÅ, ‚Ä¶, w‚Çõ ‚Ü¶ w'‚Çõ}</code>.</p>
<p>Now let <code>ùíû'</code> have patterns <code>Œ¥(p‚Çò‚Çä‚ÇÅ), ‚Ä¶, Œ¥(p‚Çñ)</code> and let
<code>e' ‚âî (œÉ ‚à™ Œ¥)(e)</code>. It should be clear that <code>e'</code> has no type variables in
it and that all local variable references in <code>e'</code> are among
<code>w'‚ÇÅ, ‚Ä¶, w'‚Çõ</code>. Note that <code>e'</code> is not yet monomorphized. Proceed to the
next step to achieve that.</p>
<h3 id="expressions"><a class="header" href="#expressions">Expressions</a></h3>
<p>The input is an expression <code>e</code> that has no type variables in it. The
goal is to replace the concrete type applications by the corresponding
monomorphized expression.</p>
<p>The only interesting case is when we find an application. Consider the
unfolded view of the application: <code>f a‚ÇÅ ‚Ä¶ a‚Çò</code>. Then, if <code>f</code> is either a
constructor, or a function, let <code>A‚ÇÅ, ‚Ä¶, A‚Çñ</code> with <code>k ‚â§ m</code> be the list of
type parameters of <code>f</code>.</p>
<ul>
<li>If <code>f</code> is a function and <code>f a‚ÇÅ ‚Ä¶ a‚Çñ ‚àâ ‚Ñí</code> then recurse normally,
otherwise, let <code>√¢ ‚âî a‚ÇÅ ‚Ä¶ a‚Çñ</code> and replace the original expression
<code>f a‚ÇÅ ‚Ä¶ a‚Çò</code>, by <code>‚ãÜ(f √¢) a‚Çñ‚Çä‚ÇÅ' ‚Ä¶ a‚Çò'</code> where <code>a‚Çñ‚Çä‚ÇÅ' ‚Ä¶ a‚Çò'</code> are the monomorphization of
<code>a‚Çñ‚Çä‚ÇÅ ‚Ä¶ a‚Çò</code> respectively.</li>
<li>If <code>f</code> is a constructor, let <code>d</code> be its inductive type. Then check
<code>d a‚ÇÅ ‚Ä¶ a‚Çñ ‚àà ‚Ñí</code>. Proceed analogously as before.</li>
</ul>
<h3 id="types"><a class="header" href="#types">Types</a></h3>
<p>The input is a type <code>t</code> that has no type variables in it. The goal is to
replace the concrete type applications by the corresponding
monomorphized type. Proceed analogously to the previous section.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="minijuvix-1"><a class="header" href="#minijuvix-1">MiniJuvix</a></h1>
<a href="https://github.com/heliaxdev/minijuvix/blob/main/LICENSE">
<img alt="LICENSE" src="https://img.shields.io/badge/license-GPL--3.0--only-blue.svg" />
</a>
<a href="https://github.com/heliaxdev/MiniJuvix/actions/workflows/ci.yml">
<img alt="CI status" src="https://github.com/heliaxdev/MiniJuvix/actions/workflows/ci.yml/badge.svg" />
</a>
<a href="https://github.com/heliaxdev/minijuvix/tags">
<img alt="" src="https://img.shields.io/github/v/release/heliaxdev/minijuvix?include_prereleases" />
</a>
<a href="https://github.com/heliaxdev/minijuvix/issues">
<img alt="" src="https://img.shields.io/github/issues/heliaxdev/minijuvix" />
</a>
<a href="https://github.com/heliaxdev/MiniJuvix">
<img align="right" width="300" height="300" alt="MiniJuvix Mascot" src="https://juvix.org/_nuxt/img/seating-mascot.051c86a.svg" />
</a>
<p>MiniJuvix is a pre-alpha programming language for writing efficient
formally-verified <a href="https://anoma.network/blog/validity-predicates/">validity
predicates</a>, which can
be deployed to various distributed ledgers. MiniJuvix is part of the
Anoma's Juvix Toolkit. At the moment, this is software released for
experimentation and research purposes only as no warranty is provided or
implied yet.</p>
<p>MiniJuvix aims to address many issues that we have experienced while
trying to write and deploy decentralized applications present in the
ecosystem of smart-contracts:</p>
<ul>
<li>the difficulty of adequate program verification,</li>
<li>the ceiling of compositional complexity,</li>
<li>the illegibility of execution costs, and</li>
<li>the lock-in to particular backends.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-minijuvix-dev-team"><a class="header" href="#the-minijuvix-dev-team">The MiniJuvix Dev Team</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="minijuvix-community"><a class="header" href="#minijuvix-community">MiniJuvix community</a></h1>
<p>We would love to hear what you think of MiniJuvix! Join us on
<a href="https://discord.gg/nsGaCZzJ">Discord</a></p>
<p>This project is part of a bigger effort called
<a href="https://anoma.net/">Anoma</a>. Anoma is a suite of protocols and
mechanisms for self-contained, self-sovereign coordination. Join the
<a href="https://anoma.net/community">Anoma project</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>
    </body>
</html>
